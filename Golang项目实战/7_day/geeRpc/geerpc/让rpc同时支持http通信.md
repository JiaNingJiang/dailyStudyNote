​	假设浏览器与服务器之间的 `HTTPS` 通信都是加密的，浏览器通过代理服务器发起 `HTTPS` 请求时，由于请求的站点地址和端口号都是加密保存在  `HTTPS` 请求报文头中的，代理服务器如何知道往哪里发送请求呢？为了解决这个问题，浏览器通过 `HTTP` 明文形式向代理服务器发送一个  `CONNECT` 请求告诉代理服务器目标地址和端口，代理服务器接收到这个请求后，会在对应端口与目标站点建立一个 TCP 连接，连接建立成功后返回  `HTTP` 200 状态码告诉浏览器与该站点的加密通道已经完成。接下来代理服务器仅需透传浏览器和服务器之间的加密数据包即可，代理服务器无需解析  `HTTPS` 报文。



​	举一个简单例子：

1. 浏览器向代理服务器发送 CONNECT 请求。

```
CONNECT geektutu.com:443 HTTP/1.0
```

2. 代理服务器返回 HTTP 200 状态码表示连接已经建立。

```
HTTP/1.0 200 Connection Established
```

3. 之后浏览器和服务器开始 `HTTPS` 握手并交换加密数据，代理服务器只负责传输彼此的数据包，并不能读取具体数据内容（代理服务器也可以选择安装可信根证书解密 `HTTPS` 报文）。

​	事实上，这个过程其实是通过代理服务器将 `HTTP` 协议转换为 `HTTPS` 协议的过程。对 `RPC` 服务端来，需要做的是将 `HTTP` 协议转换为 `RPC` 协议，对客户端来说，需要新增通过 `HTTP CONNECT` 请求创建连接的逻辑。



​	通信过程应该是这样的：

1. 客户端向 `RPC` 服务器发送 CONNECT 请求

```
CONNECT 10.0.0.1:9999/_geerpc_ HTTP/1.0
```

2. `RPC` 服务器返回 `HTTP 200` 状态码表示连接建立。

```
HTTP/1.0 200 Connected to Gee RPC
```

3. 客户端使用创建好的连接发送 `RPC` 报文，先发送 Option，再发送 N 个请求报文，服务端处理 `RPC` 请求并响应。



