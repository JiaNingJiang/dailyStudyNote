# 一、快速返回逻辑视图（混合开发模式，前后端不分离）

## 1.1 开发模式

![image-20240623114826309](05.返回数据.assets/image-20240623114826309.png)

## 1.2 `jsp` 技术

只能返回动态的 html 页面，只能由浏览器访问。

![image-20240623114916330](05.返回数据.assets/image-20240623114916330.png)

## 1.3 `jsp` 依赖

![image-20240623115025046](05.返回数据.assets/image-20240623115025046.png)

## 1.4 创建一个 `jsp` 模板页面

`jsp` 页面可以**从共享域获取数据**。

![image-20240623115115296](05.返回数据.assets/image-20240623115115296.png)

下面就是从共享域获取名为 `data` 的数据，并标红：

![image-20240623115245013](05.返回数据.assets/image-20240623115245013.png)

## 1.5 配置视图解析

![image-20240623115413942](05.返回数据.assets/image-20240623115413942.png)

在配置类中配置视图解析器：

1. 让配置类实现 `WebMvcConfigurer` 接口
2. 配置类重写 `configureViewResolvers()` 方法
3. 因为使用的是 `jsp` ,因此指定 jsp 文件的前后缀 

## 1.6 初始化 ioc 容器

新建一个类，这个类需要继承 `AbstractAnnotationConfig…………` 这个类，并重写三个方法

## 1.7 实现 controller 层

![image-20240623120106939](05.返回数据.assets/image-20240623120106939.png)

> 返回值正好是 `jsp` 指定的前缀后的页面名称，通过拼接方式获取 `html` 页面的真实 `url`：`/WEB-INF/views/index.html`

# 二、实现资源访问的转发

返回值使用 `"forward:/转发地址"`

![image-20240623120202124](05.返回数据.assets/image-20240623120202124.png)

# 三、实现资源访问的重定向

返回值使用 `"redirect:/重定向地址"`



![image-20240623120247681](05.返回数据.assets/image-20240623120247681.png)

> java-web 开发中，重定向属于是二次请求，必须是完整的资源路径，因此必须要添加项目的根路径（`Application context`），而转发不需要添加项目的根路径。
>
> 当使用了 `spring-mvc` 进行开发时，自动的为我们省去了在重定向中添加项目根路径的行为，因此也不需要添加根路径。

重定向除了项目下的资源，还可以到其他任意可以访问到的其他资源：

![image-20240623120428092](05.返回数据.assets/image-20240623120428092.png)

# 四、返回 `json` 数据

要返回 `json` 数据：

1. 直接返回对象即可
2. 方法上添加 `@ResponseBody` 注解（注意：和 `@RequestBody` 进行区分）

![image-20240623124009830](05.返回数据.assets/image-20240623124009830.png)

如果要返回的是集合，也同理：

<img src="05.返回数据.assets/image-20240623124117289.png" alt="image-20240623124117289" style="zoom:67%;" />

`@ResponseBody` 可以直接加在类上，如果类中所有方法都返回 `json` 数据的话，可以这样做：

![image-20240623124308535](05.返回数据.assets/image-20240623124308535.png)

也可以直接使用 `@RestController` 注解：

<img src="05.返回数据.assets/image-20240623124345092.png" alt="image-20240623124345092" style="zoom:67%;" />

这个注解等同于 `@ResponseBody` + `@Controller`

**注意：**

![image-20240623124451287](05.返回数据.assets/image-20240623124451287.png)

# 五、返回静态资源

我们在 `webapp` 下放置我们的静态资源 `mi.png` ：

![image-20240623124548342](05.返回数据.assets/image-20240623124548342.png)

如果使用的是 `spring-mvc` ，我们通过路径 `/images/mi.png` 是无法访问到这张图片的，原因是：

`DispatchServlet` 在处理所有的资源访问请求时，都会先去 `HandlerMapping` 去查找资源 url 对应的 handler，这里的静态资源明显没有在 `HandlerMapping` 中进行注册，因此 `HandlerMapping` 找不到对应的记录，就会返回 404 错误。

为了实现静态资源查找功能了，按如下方式设置我们的配置类：

![image-20240623124958354](05.返回数据.assets/image-20240623124958354.png)

其底层的原理是：如果根据资源地址找不到对应的 handler，就会通过**转发**的方式在当前项目资源路径下去找静态资源。